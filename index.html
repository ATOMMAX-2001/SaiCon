<!DOCTYPE html>
<html>
<head>
    <title>SaiCon</title>
</head>
<style type="text/css">
    .title{
        font-size: 50px;
        font-family: monospace;
        color: white;
        font-weight: bold;
    }
    body{
        background-color: black;
    }
    input{
        border: none;
        padding: 0 1rem;
        flex-grow: 1; 
        border-radius: 2rem;
        margin: 0.25rem; 
        font-size: 15px;
    }
    form{
         background: rgba(0, 0, 0, 0.15);
          padding: 0.25rem; 
          position: fixed; 
          bottom: 0;
          left: 0;
          right: 0;
          display: flex;
          height: 3rem;
          box-sizing: border-box; 
          backdrop-filter: blur(10px);
    }
    button{
        background: #333; 
        border: none; 
        padding: 0 1rem; 
        margin: 0.25rem; 
        border-radius: 3px; 
        outline: none; color: #fff; 
    }
    li{
        color:white;
        padding: 5px 10px;
        background-color: purple;
        list-style-type:none;
        border-radius: 20px;
        width: auto;
        height: auto;
        min-height: 1%;
        min-width: 10%;
        max-width: 30%;
        margin-bottom: 1%;
        overflow-wrap:break-word;
    }
</style>
<body>
    <header>
        <center><h1 class="title">SaiCon</h1></center>
        <div>
        <center><pre><h3 style="color:green;font-size:20px;">Users Online: <h3 id='userCount' style="color:green;font-size:20px;">0</h3></h3></pre></center>
        </div>
    </header>
    <main>
        <ul id="message"></ul>
        <form id="form">
            <input id="input" type="text" name="user_message" placeholder="Type Something...">
            <button>Send</button>
        </form>
    </main>
</body>
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io();
  let form = document.getElementById('form');
  let input = document.getElementById('input');
  socket.emit('user-count');
  form.addEventListener('submit',function(e){
    e.preventDefault();
    if(input.value){
        socket.emit('students-message',input.value);
        input.value="";
    }
  });
  socket.on('user-count',function(count){
    document.getElementById('userCount').textContent=count;
  });

  socket.on('students-message',function(msg,totalCount){
    document.getElementById('userCount').textContent=totalCount;
    if(msg.length!=0){
        let newMessage = document.createElement('li');
        newMessage.textContent = msg;
        let date = new Date();
        let currentTime =date.getHours()+":"+date.getMinutes();
        newMessage.innerHTML=msg+"<p style='float:right;margin-top:-0.1%;'>"+currentTime+"</p>"
        message.appendChild(newMessage);
        message.appendChild(document.createElement('br'));
        window.scrollTo(0,document.body.scrollHeight);
    }
  });
  
</script>
</html>